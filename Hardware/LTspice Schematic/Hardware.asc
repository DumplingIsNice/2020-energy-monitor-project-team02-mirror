Version 4
SHEET 1 3756 1488
WIRE -1072 -288 -1152 -288
WIRE -992 -288 -1008 -288
WIRE -880 -288 -912 -288
WIRE -848 -288 -880 -288
WIRE -768 -288 -848 -288
WIRE -432 -288 -512 -288
WIRE -160 -288 -432 -288
WIRE -32 -288 -160 -288
WIRE 256 -272 96 -272
WIRE -32 -256 -32 -288
WIRE 96 -192 96 -272
WIRE 160 -192 96 -192
WIRE -160 -176 -160 -288
WIRE 256 -176 256 -272
WIRE 256 -176 224 -176
WIRE 352 -176 256 -176
WIRE -32 -160 -32 -176
WIRE 160 -160 -32 -160
WIRE -848 -128 -848 -288
WIRE -432 -128 -432 -288
WIRE -32 -128 -32 -160
WIRE -32 -16 -32 -48
WIRE -1120 32 -1152 32
WIRE -848 32 -848 -64
WIRE -848 32 -1120 32
WIRE -640 32 -640 -192
WIRE -640 32 -848 32
WIRE -432 32 -432 -64
WIRE -432 32 -640 32
WIRE -160 32 -160 -96
WIRE -160 32 -432 32
WIRE -1120 48 -1120 32
WIRE 48 272 32 272
WIRE 160 272 128 272
WIRE -80 336 -112 336
WIRE 32 336 32 272
WIRE 32 336 0 336
WIRE 32 352 32 336
WIRE 64 352 32 352
WIRE 800 352 800 288
WIRE 832 352 800 352
WIRE 160 368 160 272
WIRE 160 368 128 368
WIRE 192 368 160 368
WIRE 992 368 896 368
WIRE 64 384 32 384
WIRE 832 384 800 384
WIRE -80 400 -112 400
WIRE 32 400 32 384
WIRE 32 400 0 400
WIRE 32 416 32 400
WIRE -976 480 -1120 480
WIRE -784 480 -976 480
WIRE -528 480 -784 480
WIRE -784 512 -784 480
WIRE 32 512 32 496
WIRE -528 528 -528 480
WIRE -1120 624 -1120 480
WIRE -784 624 -784 592
WIRE -528 688 -528 608
WIRE -400 688 -528 688
WIRE 816 720 784 720
WIRE 944 720 896 720
WIRE 1008 720 944 720
WIRE -528 736 -528 688
WIRE -784 752 -784 704
WIRE -672 752 -784 752
WIRE -656 752 -672 752
WIRE 944 752 944 720
WIRE -784 768 -784 752
WIRE 944 848 944 816
WIRE -1120 864 -1120 704
WIRE -960 864 -1120 864
WIRE -784 864 -784 848
WIRE -784 864 -960 864
WIRE -528 864 -528 816
WIRE -528 864 -784 864
WIRE 32 992 16 992
WIRE 144 992 112 992
WIRE -96 1056 -128 1056
WIRE 16 1056 16 992
WIRE 16 1056 -16 1056
WIRE 16 1072 16 1056
WIRE 48 1072 16 1072
WIRE 800 1072 768 1072
WIRE 928 1072 880 1072
WIRE 992 1072 928 1072
WIRE 144 1088 144 992
WIRE 144 1088 112 1088
WIRE 176 1088 144 1088
WIRE 48 1104 16 1104
WIRE 928 1104 928 1072
WIRE -96 1120 -128 1120
WIRE 16 1120 16 1104
WIRE 16 1120 -16 1120
WIRE 16 1136 16 1120
WIRE 928 1200 928 1168
WIRE 16 1232 16 1216
FLAG -1152 -640 0
FLAG -960 864 0
FLAG -1152 -720 5VDis
FLAG -976 480 Vac
FLAG -1120 48 0
FLAG -672 752 Vis
FLAG 80 1120 0
FLAG 80 1056 5V
FLAG -128 1120 Vis
FLAG -128 1056 0
FLAG 176 1088 Vio
FLAG 16 1232 2V1
FLAG 96 400 0
FLAG 96 336 5V
FLAG -112 336 0
FLAG 192 368 Vvo
FLAG 32 512 2V1
FLAG -1152 -288 Vac
FLAG -160 -288 5V
FLAG 944 848 0
FLAG 784 720 Vvo
FLAG 1008 720 Vvofilter
FLAG -880 -288 Vin
FLAG -400 688 Vvs
FLAG -112 400 Vvs
FLAG 352 -176 2V1
FLAG -32 -16 0
FLAG 192 -144 0
FLAG 192 -208 5V
FLAG 864 400 0
FLAG 864 336 5V
FLAG 992 368 Vzero
FLAG 800 384 Vvo
FLAG 800 288 2V1
FLAG 928 1200 0
FLAG 768 1072 Vio
FLAG 992 1072 Viofilter
SYMBOL voltage -1152 -736 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5V
SYMBOL voltage -1120 608 R0
WINDOW 0 -136 4 Left 2
WINDOW 3 -242 82 Left 2
WINDOW 123 -242 110 Left 2
WINDOW 39 0 0 Left 0
SYMATTR InstName Vsupply1
SYMATTR Value SINE(0 {Vp} {F})
SYMATTR Value2 AC {Vp} 0
SYMBOL PowerProducts/LT1085-5 -640 -288 R0
SYMATTR InstName Reg1
SYMBOL res -176 -192 R0
SYMATTR InstName RL1
SYMATTR Value 100
SYMBOL res -896 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rin1
SYMATTR Value 33
SYMBOL diode -1072 -272 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL cap -864 -128 R0
SYMATTR InstName Cin1
SYMATTR Value 470µ
SYMATTR SpiceLine Rser=0.001
SYMBOL cap -448 -128 R0
SYMATTR InstName Cout1
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=0.001
SYMBOL res -800 608 R0
SYMATTR InstName Rload1
SYMATTR Value {RL}
SYMBOL ind -800 496 R0
SYMATTR InstName Lload1
SYMATTR Value 40mH
SYMBOL res -800 752 R0
SYMATTR InstName Rs1
SYMATTR Value 0.56
SYMBOL res -544 512 R0
SYMATTR InstName Ra1
SYMATTR Value 56k
SYMBOL res -544 720 R0
SYMATTR InstName Rb1
SYMATTR Value 3.3k
SYMBOL Opamps/opamp2 80 1024 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL res 0 1104 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R9
SYMATTR Value {R1}
SYMBOL res 0 1040 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R10
SYMATTR Value {R1}
SYMBOL res 128 976 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R11
SYMATTR Value {R2}
SYMBOL res 32 1232 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R12
SYMATTR Value {R2}
SYMBOL Opamps/opamp2 96 304 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U4
SYMATTR Value LM324
SYMBOL res 16 384 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R13
SYMATTR Value {Rb}
SYMBOL res 16 320 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R14
SYMATTR Value {Ra}
SYMBOL res 144 256 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R15
SYMATTR Value {R23}
SYMBOL res 48 512 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R16
SYMATTR Value {R23}
SYMBOL res 912 704 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf1
SYMATTR Value 33k
SYMBOL cap 960 816 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf1
SYMATTR Value 4.8n
SYMBOL res -48 -272 R0
SYMATTR InstName R17
SYMATTR Value 18k
SYMBOL res -48 -144 R0
SYMATTR InstName R18
SYMATTR Value 13k
SYMBOL Opamps/opamp2 192 -240 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U5
SYMATTR Value LM324
SYMBOL Opamps/opamp2 864 304 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U6
SYMATTR Value LM324
SYMBOL res 896 1056 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf2
SYMATTR Value 33k
SYMBOL cap 944 1168 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf2
SYMATTR Value 4.8n
TEXT -144 -560 Left 2 ;.ac dec 30 1 1Meg
TEXT -144 -624 Left 2 !.lib LM324.lib
TEXT -1200 -840 Left 2 ;Power/Signal Sources
TEXT -1208 -1024 Left 3 ;*********************************************************\nELECTENG 209 - Hardware\nModels required provided as a starting point.\nLM324.lib must be in the same folder.\n*********************************************************
TEXT -1192 376 Left 2 ;AC Source, Load and Sensors
TEXT -1200 -568 Left 2 ;Notes: \n- Ideal 5V source used to generate the frequency plot.\n- Switch top rail of op amp to 5VDis for frequency.\n- Switch top rail of op amp to 5V for transient (linear regulator).
TEXT -1184 944 Left 2 ;Notes: \n- Rload is the variable resistor in your load which changes \n  from 5-105 ohms \n- Vsupply is between 12.6-15.4Vrms
TEXT -832 520 Right 2 ;Load \n(2.5VA-7.5VA)
TEXT -832 776 Right 2 ;Current Sens \n(Pmax=198.2mW)\n(Imax=598.7mA)
TEXT -584 408 Left 2 ;Voltage Sens\n(Vvs(max)=21.79V)
TEXT -152 -688 Left 2 ;Simulation Commands\n- Change these as needed
TEXT -224 896 Left 2 ;Current Sensor
TEXT -224 1320 Left 2 ;Notes: \n- Amplifies and level shifts.
TEXT -208 176 Left 2 ;Voltage Sensor
TEXT -208 600 Left 2 ;Notes: \n- R1a together with Thevenin of Ra & Rb should equal R1b\n- Gain = 1, only level shifts.
TEXT -1200 -408 Left 2 ;Power Supply (5V)
TEXT 720 624 Left 2 ;Voltage Filter Circuit (1kHz fbreak)
TEXT 688 1304 Left 2 ;Notes: \n- Change the simulation command to simulate the frequency response.\n- The inductor in the load constitute as a low pass filter. That filter and the succeeding opAmp contributes to the overall bandwidth.\n- The bode plot must be measured with ideal 5V source and relative to its input (V(viofilter)/V(vio)).\n- Fc = 1/((2*pi)*R*C)
TEXT -144 -592 Left 2 !.tran 0 1 0 1m
TEXT -144 -528 Left 2 !.ic V(Vin)=8
TEXT -1168 136 Left 2 ;Notes: \n- 5V DC Linear Regulator, output load will not impact input current.\n- Assume: Iin = IL\n- Efficency = Power Delivered/Total Power = (IL*VL)/(IL*VDC) \n      // Changing the output load will not impact efficency
TEXT -224 1408 Left 2 !.param R1=22k R2=56k
TEXT -208 704 Left 2 !.param Rb=1.5k Ra=4.7k R23=4.7k
TEXT 720 160 Left 2 ;Zero-crossing Detector
TEXT -1072 1136 Left 2 ;.param Vp=sqrt(2)*12.6 F=50 RL=16.65
TEXT -1072 1232 Left 2 ;.param Vp=sqrt(2)*15.4 F=50 RL=29
TEXT -1072 1328 Left 2 !.param Vp=sqrt(2)*15.4 F=50 RL=92.82
TEXT -1064 1104 Left 2 ;7.5VA
TEXT -1064 1208 Left 2 ;7.5VA
TEXT -1064 1304 Left 2 ;2.5VA
TEXT 720 952 Left 2 ;Current Filter Circuit (1kHz fbreak)
TEXT 704 440 Left 2 ;Notes: \n- Basic comparator with VOH and VOL at Vvo = 2.1V.\n- Digital one on first crossing, positively aligned.
TEXT 112 -64 Left 2 ;Notes: \n- Voltage divider and unity gain voltage follower to derive Vshift from power supply.
RECTANGLE Normal -824 500 -696 716 2
RECTANGLE Normal -824 744 -696 856 2
RECTANGLE Normal -580 452 -444 888 2
RECTANGLE Normal -184 -704 252 -500 2
